<!DOCTYPE html>


<html lang="zh-CN">


<head>
  <meta charset="utf-8" />
    
  <meta name="description" content="Kæ®¿" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    Docker |  Kæ®¿
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Khighness/Khighness.github.io/k.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
  
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>

  
  

<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'ParaK', 'auto');
ga('send', 'pageview');

</script>



  
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?ParaK";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>


  <!-- å°é¢æ ‡é¢˜é—ªçƒ -->
  <link rel="stylesheet" href="/css/titleFlash.css">
  <!-- æµè§ˆå™¨æç¬‘æ ‡é¢˜ -->
<!--  <script type="text/javascript">
  //
  var OriginTitle = document.title;
  var titleTime;
  document.addEventListener('visibilitychange', function () {
      if (location.href != "https://www.xxxzhy.com/"){//ä¸»é¡µä¸å˜
          if (document.hidden) {
              //$('[rel="icon"]').attr('href', "/funny.ico");
              document.title = '/(ã„’oã„’)/ä½ å¼„ä¸¢äº†XXXZhy';
              clearTimeout(titleTime);
          }else {
              //$('[rel="icon"]').attr('href', "/favicon.ico");
              document.title = '(à¸…>Ï‰<*à¸…) å™«åˆå¥½å•¦~' + OriginTitle;
              titleTime = setTimeout(function () {
                  document.title = OriginTitle;
              }, 2000);
          }
      }
  });
  </script> -->
  <!-- ç™¾åº¦è‡ªåŠ¨æ¨é€ -->
  <script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
  </script>
<link rel="alternate" href="/atom.xml" title="Khighness" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

</html>


<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-Docker"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  Docker
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/posts/f5f9fa9b/" class="article-date">
  <time datetime="2020-12-01T16:00:00.000Z" itemprop="datePublished">2020-12-02</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/DevOps/">DevOps</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> å­—æ•°ç»Ÿè®¡:</span>
            <span class="post-count">8.7k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> é˜…è¯»æ—¶é•¿â‰ˆ</span>
            <span class="post-count">44 åˆ†é’Ÿ</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h1><center>
    <font face="Kristen ITC" color="#555555" size=3>ğŸ’¤ Khighness ğŸ’¤</font><br>
</center>



<h2 id="ğŸ“–æ¦‚è¿°"><a href="#ğŸ“–æ¦‚è¿°" class="headerlink" title="ğŸ“–æ¦‚è¿°"></a>ğŸ“–æ¦‚è¿°</h2>

<blockquote>
<p>æ•…äº‹</p>
</blockquote>
<p>2010å¹´ï¼Œå‡ ä¸ªæ IT çš„å¹´è½»äººï¼Œåœ¨ç¾å›½æ—§é‡‘å±±æˆç«‹äº†ä¸€å®¶åå« <code>dotCloud </code>çš„å…¬å¸ã€‚<code>dotCloud </code>çš„å¹³å°å³æœåŠ¡ï¼ˆPlatform-as-a-Serviceï¼‰æä¾›å•†ã€‚åº•å±‚æŠ€æœ¯ä¸Šï¼Œ<code>dotCloud</code> å¹³å°åˆ©ç”¨äº†<code>Linux</code>çš„ <code>LXC </code>å®¹å™¨æŠ€æœ¯ã€‚ä¸ºäº†æ–¹ä¾¿åˆ›å»ºå’Œç®¡ç†è¿™äº›å®¹å™¨ï¼Œ<code>dotCloud </code>åŸºäº Google å…¬å¸æ¨å‡ºçš„ <code>Go </code>è¯­è¨€å¼€å‘äº†ä¸€å¥—å†…éƒ¨å·¥å…·ï¼Œä¹‹åè¢«å‘½åä¸º <code>Docker</code>ã€‚<code>Docker </code>å°±æ˜¯è¿™æ ·è¯ç”Ÿçš„ã€‚</p>
<p>2013å¹´çš„åç«¯æŠ€æœ¯é¢†åŸŸå·²ç»å¤ªä¹…æ²¡æœ‰å‡ºç°è®©äººæŒ¯å¥‹çš„ä¸œè¥¿äº†ã€‚å½“ç„¶<code>Docker</code>åœ¨å‘è¡Œä¹‹åä¹Ÿæ²¡ç”¨å¼•èµ·è¡Œä¸šçš„å…³æ³¨ã€‚åœ¨å¼€æºä¹‹åæ‰çˆ†ç«ã€‚</p>
<p><code>Docker</code>å®šä¹‰å®¹å™¨æŠ€æœ¯æ ‡ç –ä½¿å¾—å®¹å™¨æŠ€æœ¯çš„è½åœ°å˜å¾—ååˆ†ç®€å•ï¼Œåº”ç”¨å¯ä»¥ç¨³å®šä¾¿æºçš„è¿è¡Œåœ¨å®¹å™¨ä¸­ã€‚</p>
<a id="more"></a>



<blockquote>
<p>ç‰¹ç‚¹</p>
</blockquote>
<ul>
<li><strong>æ›´å¿«é€Ÿçš„åº”ç”¨äº¤ä»˜å’Œéƒ¨ç½²</strong></li>
<li><strong>æ›´ä¾¿æ·çš„å‡çº§å’Œæ‰©ç¼©å®¹</strong></li>
<li><strong>æ›´é«˜æ•ˆçš„è®¡ç®—èµ„æºåˆ©ç”¨</strong></li>
<li><strong>æ›´ç®€å•çš„ç³»ç»Ÿè¿ç»´</strong></li>
</ul>
<blockquote>
<p>æ¶æ„</p>
</blockquote>
<img src="/posts/f5f9fa9b/Docker%E6%9E%B6%E6%9E%84.jpg" class="" title="Docker">

<p><strong>é•œåƒï¼ˆimageï¼‰ï¼š</strong> ç›¸å½“äºä¸€ä¸ªæ¨¡æ¿ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæ¨¡æ¿æ¥åˆ›å»ºå®¹å™¨æœåŠ¡</p>
<p><strong>å®¹å™¨ï¼ˆcontainerï¼‰ï¼š</strong> ç‹¬ç«‹è¿è¡Œä¸€ä¸ªæˆ–è€…ä¸€ä¸ªç»„åº”ç”¨</p>
<p><strong>ä»“åº“ï¼ˆrepositoryï¼‰ï¼š</strong> å­˜æ”¾é•œåƒçš„åœ°æ–¹</p>
<h2 id="ğŸ”¨å®‰è£…"><a href="#ğŸ”¨å®‰è£…" class="headerlink" title="ğŸ”¨å®‰è£…"></a>ğŸ”¨å®‰è£…</h2><blockquote>
<p>å®˜æ–¹æ–‡æ¡£</p>
</blockquote>
<p>CentOS 7å®‰è£…ï¼š<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
<blockquote>
<p>å¸è½½æ—§ç‰ˆæœ¬</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è®¾ç½®å­˜å‚¨åº“</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum install -y yum-utils<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>æ›´æ¢é•œåƒæº</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>æ›´æ–°YUMåŒ…</p>
<p>æ›´æ–°YUMç´¢å¼•</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum update
$ sudo yum makecache fast<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>å®‰è£…dockerå¼•æ“å’Œå®¹å™¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum install docker-ce docker-ce-cli containerd.io<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>å¯åŠ¨Dockerå¹¶æµ‹è¯•hello-world</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo systemctl start docker
$ sudo docker run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>å¸è½½æ–¹å¼</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ sudo yum remove docker-ce docker-ce-cli containerd.io
$ sudo rm -rf /var/lib/docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>é•œåƒåŠ é€Ÿ</p>
</blockquote>
<p>1ï¸âƒ£ä½¿ç”¨é˜¿é‡Œé•œåƒåŠ é€Ÿå™¨</p>
<img src="/posts/f5f9fa9b/image-20201206122604398.png" class="" title="image-20201206122604398">

<p>2ï¸âƒ£ä½¿ç”¨ä¸­ç§‘å¤§æˆ–è€…ç½‘æ˜“é•œåƒåŠ é€Ÿ</p>
<pre class="line-numbers language-shell"><code class="language-shell"># æ·»åŠ daemon.json
$ touch /etc/docker/daemon.json

# å†™å…¥å†…å®¹å¹¶ä¿å­˜
# ç§‘å¤§æº: https://docker.mirrors.ustc.edu.cn/
# ç½‘æ˜“æºï¼šhttp://hub-mirror.c.163.com
&#123;
  "registry-mirrors": ["https://docker.mirrors.ustc.edu.cn/"]
&#125;

# é‡å¯Dicker
$ sudo systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸš€åŸç†"><a href="#ğŸš€åŸç†" class="headerlink" title="ğŸš€åŸç†"></a>ğŸš€åŸç†</h2><blockquote>
<p>docker runçš„æ‰§è¡Œæµç¨‹</p>
</blockquote>
<img src="Docker/image-20201203233730702.png" alt="image-20201203233730702" style="zoom:88%;" />

<blockquote>
<p>Dockerçš„å·¥ä½œ</p>
</blockquote>
<p>Dockeræ˜¯ä¸€ä¸ªClient-Serverç»“æ„çš„ç³»ç»Ÿï¼ŒDockerçš„å®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨ä¸»æœºä¸Šã€‚é€šè¿‡Socketä»å®¢æˆ·ç«¯è®¿é—®ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆDockeræ¯”VMå¿«ï¼Ÿ</strong></p>
<img src="/posts/f5f9fa9b/image-20201204003500802.png" class="" title="image-20201204003500802">

<p>1ã€Dockeræœ‰æ¯”è™šæ‹Ÿæœºæ›´å°‘çš„æŠ½è±¡å±‚ã€‚Dockerä¸éœ€è¦Hypervisorå®ç°ç¡¬ä»¶èµ„æºè™šæ‹ŸåŒ–ï¼Œè¿è¡Œåœ¨Dockerå®¹å™¨ä¸Šçš„ç¨‹åºç›´æ¥ä½¿ç”¨çš„æ˜¯å®é™…ç‰©ç†æœºçš„ç¡¬ä»¶èµ„æºï¼Œå› æ­¤åœ¨CPUã€å†…å­˜åˆ©ç”¨ç‡ä¸ŠDockerå°†ä¼šåœ¨æ•ˆç‡ä¸Šæœ‰æ˜æ˜¾çš„ä¼˜åŠ¿ã€‚</p>
<p>2ã€Dockeråˆ©ç”¨çš„æ˜¯å®¿ä¸»æœºçš„å†…æ ¸ï¼Œè€Œä¸éœ€è¦Guest OSã€‚å› æ­¤åˆ›å»ºä¸€ä¸ªå®¹å™¨æ—¶ï¼Œä¸éœ€è¦å’Œè™šæ‹Ÿæœºä¸€æ ·é‡æ–°åŠ è½½ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ä»è€Œé¿å…å¼•å¯»ã€åŠ è½½æ“ä½œç³»ç»Ÿå†…æ ¸è¿”å›æ—¶è€—æ—¶è€—èµ„æºçš„è¿‡ç¨‹ï¼Œå½“æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ—¶ï¼Œè™šæ‹Ÿæœºè½¯ä»¶éœ€è¦åŠ è½½Guest OSï¼Œè¿”å›æ–°å»ºè¿‡ç¨‹æ˜¯åˆ†é’Ÿçº§åˆ«çš„ã€‚è€Œæ–°å»ºä¸€ä¸ªDockerå®¹å™¨åªéœ€è¦å‡ ç§’é’Ÿã€‚</p>
<p>3ã€Dockerä¸VMç›¸æ¯”ï¼š</p>
<ul>
<li>Dockerçµæ´»ï¼ŒVMç¬¨é‡</li>
<li>Dockerå­˜å‚¨çš„é•œåƒå°ï¼Œä¾¿äºå­˜å‚¨å’Œä¼ è¾“ï¼ŒVMé•œåƒåºå¤§</li>
</ul>
<h2 id="ğŸ”°å‘½ä»¤"><a href="#ğŸ”°å‘½ä»¤" class="headerlink" title="ğŸ”°å‘½ä»¤"></a>ğŸ”°å‘½ä»¤</h2><blockquote>
<p>ğŸŒå®˜æ–¹æ–‡æ¡£</p>
</blockquote>
<p>Command-line referenceï¼š<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<img src="/posts/f5f9fa9b/image-20201204225734966.png" class="" title="image-20201204225734966">



<h3 id="1ï¸âƒ£å¸®åŠ©å‘½ä»¤"><a href="#1ï¸âƒ£å¸®åŠ©å‘½ä»¤" class="headerlink" title="1ï¸âƒ£å¸®åŠ©å‘½ä»¤"></a>1ï¸âƒ£å¸®åŠ©å‘½ä»¤</h3><pre class="line-numbers language-shell"><code class="language-shell">$ docker version    # æ˜¾ç¤ºDockerç‰ˆæœ¬ä¿¡æ¯
$ docker info       # æ˜¾ç¤ºDockerç³»ç»Ÿä¿¡æ¯
$ docker --help     # Dockerå‘½ä»¤å¸®åŠ©ä¿¡æ¯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="2ï¸âƒ£é•œåƒå‘½ä»¤"><a href="#2ï¸âƒ£é•œåƒå‘½ä»¤" class="headerlink" title="2ï¸âƒ£é•œåƒå‘½ä»¤"></a>2ï¸âƒ£é•œåƒå‘½ä»¤</h3><blockquote>
<p>æŸ¥çœ‹é•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker images

# å¯é€‰é¡¹
-a, --all             # åˆ—å‡ºæ‰€æœ‰é•œåƒ
    --digests         # æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯
-q, --quiet           # åªæ˜¾ç¤ºé•œåƒçš„ID

# è¿è¡Œ
[root@parak khighness]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
hello-world         latest              bf756fb1ae65        11 months ago       13.3kB
# è§£é‡Š
REPOSITORY  é•œåƒçš„ä»“åº“æº
TAG         é•œåƒçš„æ ‡ç­¾
IMAGE ID    é•œåƒçš„ID
CREATED     é•œåƒçš„åˆ›å»ºæ—¶é—´
SIZE        é•œåƒçš„å¤§å°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æœç´¢é•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker search <IMAGE>

# å¯é€‰é¡¹
--filter=STARS=1000 # é•œåƒçš„STARSå¤§äº1000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ä¸‹è½½é•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker pull <IMAGE>
$ docker pull .io/library/mysql:latest

# å¦‚æœä¸å†™tagï¼Œé»˜è®¤å°±æ˜¯æœ€æ–°çš„

# æŒ‡å®šç‰ˆæœ¬ä¸‹è½½
[root@parak khighness]# docker pull mysql:8.0.20
8.0.20: Pulling from library/mysql  # åˆ†å±‚ä¸‹è½½
8559a31e96f4: Pull complete 
d51ce1c2e575: Pull complete 
c2344adc4858: Pull complete 
fcf3ceff18fc: Pull complete 
16da0c38dc5b: Pull complete 
b905d1797e97: Pull complete 
4b50d1c6b05c: Pull complete 
c75914a65ca2: Pull complete 
1ae8042bdd09: Pull complete 
453ac13c00a3: Pull complete 
9e680cd72f08: Pull complete 
a6b5dc864b6c: Pull complete 
Digest: sha256:8b7b328a7ff6de46ef96bcf83af048cb00a1c86282bfca0cb119c84568b4caf6
Status: Downloaded newer image for mysql:8.0.20
docker.io/library/mysql:8.0.20<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>åˆ é™¤é•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># é€šè¿‡é•œåƒIDåˆ é™¤
$ docker rmi -f <IMAGE ID> ...
# åˆ é™¤æ‰€æœ‰é•œåƒ
$ docker rmi -f $(docker images -aq)0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3ï¸âƒ£å®¹å™¨å‘½ä»¤"><a href="#3ï¸âƒ£å®¹å™¨å‘½ä»¤" class="headerlink" title="3ï¸âƒ£å®¹å™¨å‘½ä»¤"></a>3ï¸âƒ£å®¹å™¨å‘½ä»¤</h3><blockquote>
<p>ä¸‹è½½ä¸€ä¸ªCentOSé•œåƒæ¥æµ‹è¯•å­¦(å¥—)ä¹ (å¨ƒ)</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@parak khighness]# docker pull centos
Using default tag: latest
latest: Pulling from library/centos
3c72a8ed6814: Pull complete 
Digest: sha256:76d24f3ba3317fa945743bb3746fbaf3a0b752f10b10376960de01da70685fbd
Status: Downloaded newer image for centos:latest
docker.io/library/centos:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker run [å¯é€‰å‚æ•°] <IMAGE>

# å‚æ•°è¯´æ˜
--name="NAME"   å®¹å™¨åå­—ï¼Œç”¨äºåŒºåˆ†å®¹å™¨
-d              åå°æ–¹å¼è¿è¡Œ
-it             ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿›å¦‚å®¹å™¨æŸ¥çœ‹å†…å®¹
-p              æŒ‡å®šå®¹å™¨ç«¯å£  -p 8080:8080
    -p ip:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£
    -p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£
    -p å®¹å™¨ç«¯å£

# æµ‹è¯•ï¼Œå¯åŠ¨å¹¶è¿›å…¥å®¹å™¨
[root@parak khighness]# docker run -it centos /bin/bash
[root@e4efa1c507b8 /]# ls
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
# ä»å®¹å™¨ä¸­é€€å›ä¸»æœº
[root@e4efa1c507b8 /]# exit
exit
[root@parak khighness]# ls
å…¬å…±  æ¨¡æ¿  è§†é¢‘  å›¾ç‰‡  æ–‡æ¡£  ä¸‹è½½  éŸ³ä¹  æ¡Œé¢<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æŸ¥çœ‹å®¹å™¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker ps  # æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
-a           # æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨+å†å²è¿è¡Œè¿‡çš„å®¹å™¨
-n=?         # æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„nä¸ªå®¹å™¨
-q           # åªæ˜¾ç¤ºå®¹å™¨çš„ç¼–å·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>é€€å‡ºå®¹å™¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ exit        <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>åˆ é™¤å®¹å™¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker rm <Container ID/NAME>    # åˆ é™¤æŒ‡å®šçš„å®¹å™¨ï¼Œä¸èƒ½åˆ é™¤åªåœ¨è¿è¡Œçš„å®¹å™¨
$ docker rm -f $(docker ps -aq)    # åˆ é™¤æ‰€æœ‰çš„å®¹å™¨
$ docker ps -a -q|xargs docker rm  # åˆ é™¤æ‰€æœ‰çš„å®¹å™¨ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>å®¹å™¨æ“ä½œ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker start   <Container ID/NAME>  # å¯åŠ¨å®¹å™¨ 
$ docker restart <Container ID/NAME>  # é‡å¯å®¹å™¨
$ docker stop    <Container ID/NAME>  # åœæ­¢å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨
$ docker kill    <Container ID/NAME>  # å¼ºåˆ¶åœæ­¢å½“å‰å®¹å™¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æŸ¥çœ‹æ—¥å¿—</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker logs -tf --tail <n> <Container ID/NAME> # æ˜¾ç¤ºæŒ‡å®šè¡Œæ•°çš„æ—¥å¿—<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>æŸ¥çœ‹å®¹å™¨ä¸­è¿›ç¨‹ä¿¡æ¯</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker top <Container ID/NAME><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>æŸ¥çœ‹é•œåƒçš„å…ƒæ•°æ®</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker inspect<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>è¿›å…¥å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker exec -it <Container ID> bashShell  
# è¿›å…¥å®¹å™¨åå¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œï¼›
# execä¹‹åä¸ä¼šç»ˆç»“å½“å‰å®¹å™¨è¿›ç¨‹

$ docker attach <Container ID>              
# è¿›å…¥å®¹å™¨ä¸­æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹
# execä¹‹åç»ˆç»“å½“å‰å®¹å™¨è¿›ç¨‹<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ä»å®¹å™¨æ‹·è´æ–°çš„ä¸œè¥¿åˆ°ä¸»æœº</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># å¼€å¯CentOSå®¹å™¨
[root@parak khighness]# docker start b9ace468ea7d
b9ace468ea7d
# è¿›å…¥CentOSå®¹å™¨
[root@parak khighness]# docker attach b9ace468ea7d
# åˆ›å»ºæ–‡ä»¶å¤¹å’Œæ–‡ä»¶
[root@b9ace468ea7d /]# cd home/
[root@b9ace468ea7d home]# mkdir document 
[root@b9ace468ea7d home]# vi K1.java
# é€€å‡ºå®¹å™¨
[root@b9ace468ea7d document]# exit
exit
# å°†å®¹å™¨æ–‡ä»¶å¤åˆ¶åˆ°ä¸»æœºä¸Š
[root@parak khighness]# docker cp b9ace468ea7d:/home/document/K1.java document/
[root@parak khighness]# cd document/
[root@parak document]# ll
æ€»ç”¨é‡ 4
-rw-r--r--. 1 root root 186 12æœˆ  5 11:33 K1.java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸ”±ç»ƒä¹ "><a href="#ğŸ”±ç»ƒä¹ " class="headerlink" title="ğŸ”±ç»ƒä¹ "></a>ğŸ”±ç»ƒä¹ </h2><h3 id="ğŸŒ -å®‰è£…Nginx"><a href="#ğŸŒ -å®‰è£…Nginx" class="headerlink" title="ğŸŒ  å®‰è£…Nginx"></a>ğŸŒ  å®‰è£…Nginx</h3><pre class="line-numbers language-shell"><code class="language-shell"># æœç´¢é•œåƒ
[root@parak khighness]# docker search nginx
NAME                               DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED
nginx                              Official build of Nginx.                        14063               [OK]                
jwilder/nginx-proxy                Automated Nginx reverse proxy for docker conâ€¦   1912                                    [OK]
richarvey/nginx-php-fpm            Container running Nginx + PHP-FPM capable ofâ€¦   795                                     [OK]
linuxserver/nginx                  An Nginx container, brought to you by LinuxSâ€¦   131                                     
jc21/nginx-proxy-manager           Docker container for managing Nginx proxy hoâ€¦   115                                     
tiangolo/nginx-rtmp                Docker image with Nginx using the nginx-rtmpâ€¦   105                                     [OK]
bitnami/nginx                      Bitnami nginx Docker Image                      90                                      [OK]
alfg/nginx-rtmp                    NGINX, nginx-rtmp-module and FFmpeg from souâ€¦   80                                      [OK]
jlesage/nginx-proxy-manager        Docker container for Nginx Proxy Manager        72                                      [OK]
nginxdemos/hello                   NGINX webserver that serves a simple page coâ€¦   63                                      [OK]
nginx/nginx-ingress                NGINX Ingress Controller for Kubernetes         45                                      
privatebin/nginx-fpm-alpine        PrivateBin running on an Nginx, php-fpm & Alâ€¦   42                                      [OK]
nginxinc/nginx-unprivileged        Unprivileged NGINX Dockerfiles                  21                                      
schmunk42/nginx-redirect           A very simple container to redirect HTTP traâ€¦   19                                      [OK]
nginx/nginx-prometheus-exporter    NGINX Prometheus Exporter                       15                                      
centos/nginx-112-centos7           Platform for running nginx 1.12 or building â€¦   15                                      
staticfloat/nginx-certbot          Opinionated setup for automatic TLS certs loâ€¦   14                                      [OK]
raulr/nginx-wordpress              Nginx front-end for the official wordpress:fâ€¦   13                                      [OK]
centos/nginx-18-centos7            Platform for running nginx 1.8 or building nâ€¦   13                                      
mailu/nginx                        Mailu nginx frontend                            8                                       [OK]
bitwarden/nginx                    The Bitwarden nginx web server acting as a râ€¦   7                                       
flashspys/nginx-static             Super Lightweight Nginx Image                   7                                       [OK]
bitnami/nginx-ingress-controller   Bitnami Docker Image for NGINX Ingress Contrâ€¦   6                                       [OK]
wodby/nginx                        Generic nginx                                   1                                       [OK]
ansibleplaybookbundle/nginx-apb    An APB to deploy NGINX                          1                                       [OK]
# ä¸‹è½½é•œåƒ
[root@parak khighness]# docker pull nginx
Using default tag: latest
latest: Pulling from library/nginx
852e50cd189d: Pull complete 
571d7e852307: Pull complete 
addb10abd9cb: Pull complete 
d20aa7ccdb77: Pull complete 
8b03f1e11359: Pull complete 
Digest: sha256:6b1daa9462046581ac15be20277a7c75476283f969cb3a61c8725ec38d3b01c3
Status: Downloaded newer image for nginx:latest
docker.io/library/nginx:latest
# æŸ¥çœ‹é•œåƒ
[root@parak khighness]# docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
nginx               latest              bc9a0695f571        10 days ago         133MB
centos              latest              0d120b6ccaa8        3 months ago        215MB
mysql               8.0.20              be0dbf01a0f3        5 months ago        541MB
hello-world         latest              bf756fb1ae65        11 months ago       13.3kB
# åå°å¯åŠ¨80ç«¯å£nginxï¼Œå¯¹å¤–å¼€æ”¾3355ç«¯å£
[root@parak khighness]# docker run -d --name nginx1 -p 3355:80 nginx 
b6072408f44cd78594f01c95bc63da6baf911f74d62bf232ec42c1cd8b08b4d0
[root@parak khighness]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES
b6072408f44c        nginx               "/docker-entrypoint.â€¦"   6 seconds ago       Up 4 seconds        0.0.0.0:3355->80/tcp   nginx1
# æµ‹è¯•ï¼Œå¯ä»¥ç”¨ip:3355åœ¨æµè§ˆå™¨è®¿é—®
[root@parak khighness]# curl localhost:3355
<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<style>
    body &#123;
        width: 35em;
        margin: 0 auto;
        font-family: Tahoma, Verdana, Arial, sans-serif;
    &#125;
</style>
</head>
<body>
<h1>Welcome to nginx!</h1>
<p>If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.</p>

<p>For online documentation and support please refer to
<a target="_blank" rel="noopener" href="http://nginx.org/">nginx.org</a>.<br/>
Commercial support is available at
<a target="_blank" rel="noopener" href="http://nginx.com/">nginx.com</a>.</p>

<p><em>Thank you for using nginx.</em></p>
</body>
</html><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="ğŸŒ -å®‰è£…Tomcat"><a href="#ğŸŒ -å®‰è£…Tomcat" class="headerlink" title="ğŸŒ  å®‰è£…Tomcat"></a>ğŸŒ  å®‰è£…Tomcat</h3><pre class="line-numbers language-shell"><code class="language-shell">[root@parak khighness]# docker pull tomcat:9.0
9.0: Pulling from library/tomcat
756975cb9c7e: Pull complete 
d77915b4e630: Pull complete 
5f37a0a41b6b: Pull complete 
96b2c1e36db5: Pull complete 
27a2d52b526e: Pull complete 
a867dba77389: Pull complete 
0939c055fb79: Pull complete 
0b0694ce0ae2: Pull complete 
81a5f8099e05: Pull complete 
c3d7917d545e: Pull complete 
Digest: sha256:a319b10d8729817c7ce0bcc2343a6f97711c7870395019340d96b6aafd6ccbea
Status: Downloaded newer image for tomcat:9.0
docker.io/library/tomcat:9.0

[root@parak khighness]# docker run -d -p 3355:8080 --name tomcat1 tomcat
48c7de09007af158b13a9bef1f2d2b77bed0c4bc2f93a4887eac427911118a9b
[root@parak khighness]# docker exec -it tomcat1 /bin/bash
root@48c7de09007a:/usr/local/tomcat# ls -al
total 128
drwxr-xr-x. 1 root root    30 Nov 19 06:16 .
drwxr-xr-x. 1 root root    20 Nov 19 06:12 ..
-rw-r--r--. 1 root root 18982 Nov 12 15:41 BUILDING.txt
-rw-r--r--. 1 root root  5409 Nov 12 15:41 CONTRIBUTING.md
-rw-r--r--. 1 root root 57092 Nov 12 15:41 LICENSE
-rw-r--r--. 1 root root  2333 Nov 12 15:41 NOTICE
-rw-r--r--. 1 root root  3257 Nov 12 15:41 README.md
-rw-r--r--. 1 root root  6898 Nov 12 15:41 RELEASE-NOTES
-rw-r--r--. 1 root root 16507 Nov 12 15:41 RUNNING.txt
drwxr-xr-x. 2 root root  4096 Nov 19 06:16 bin
drwxr-xr-x. 1 root root    22 Dec  5 13:15 conf
drwxr-xr-x. 2 root root  4096 Nov 19 06:16 lib
drwxrwxrwx. 1 root root   177 Dec  5 13:15 logs
drwxr-xr-x. 2 root root   134 Nov 19 06:16 native-jni-lib
drwxrwxrwx. 2 root root    30 Nov 19 06:16 temp
drwxr-xr-x. 2 root root     6 Nov 19 06:16 webapps
drwxr-xr-x. 7 root root    81 Nov 12 15:38 webapps.dist
drwxrwxrwx. 2 root root     6 Nov 12 15:35 work
# å¯ä»¥å‘ç°webappsç›®å½•ä¸ºç©º
root@48c7de09007a:/usr/local/tomcat# cd webapps
root@48c7de09007a:/usr/local/tomcat/webapps# ls -l
total 0

# å°†webapps.listç›®å½•ä¸‹çš„å†…å®¹æ‹·è´åˆ°webappsä¸‹ï¼Œå†ç”¨æµè§ˆå™¨æµ‹è¯•è®¿é—®
root@48c7de09007a:/usr/local/tomcat/webapps# cd ..
root@48c7de09007a:/usr/local/tomcat# cd webapps.dist/
root@48c7de09007a:/usr/local/tomcat/webapps.dist# ls
ROOT  docs  examples  host-manager  manager
root@48c7de09007a:/usr/local/tomcat/webapps.dist# cd ..
root@48c7de09007a:/usr/local/tomcat# cp -r webapps.dist/* webapps/
root@48c7de09007a:/usr/local/tomcat# cd webapps
root@48c7de09007a:/usr/local/tomcat/webapps# ls
ROOT  docs  examples  host-manager  manager<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>æµ‹è¯•è®¿é—® <a target="_blank" rel="noopener" href="http://192.168.117.155:3355/">http://192.168.117.155:3355/</a></p>
</blockquote>
<img src="/posts/f5f9fa9b/image-20201205214537503.png" class="" title="image-20201205214537503">



<h3 id="ğŸŒ å®‰è£…es-kibana"><a href="#ğŸŒ å®‰è£…es-kibana" class="headerlink" title="ğŸŒ å®‰è£…es + kibana"></a>ğŸŒ å®‰è£…es + kibana</h3><pre class="line-numbers language-shell"><code class="language-shell"># --net somenetwork ç½‘ç»œé…ç½®
$ docker run -d --name es1 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2
# æŸ¥çœ‹ä¸»æœºçŠ¶æ€
$ doucker stats

# ä¸‹è½½å¹¶è¿è¡ŒES
[root@parak khighness]#  docker run -d --name es1 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" elasticsearch:7.6.2
Unable to find image 'elasticsearch:7.6.2' locally
7.6.2: Pulling from library/elasticsearch
ab5ef0e58194: Pull complete 
c4d1ca5c8a25: Pull complete 
941a3cc8e7b8: Pull complete 
43ec483d9618: Pull complete 
c486fd200684: Pull complete 
1b960df074b2: Pull complete 
1719d48d6823: Pull complete 
Digest: sha256:1b09dbd93085a1e7bca34830e77d2981521a7210e11f11eda997add1c12711fa
Status: Downloaded newer image for elasticsearch:7.6.2
51441d9abfb966c4baa0402ceb99e702f58ec68cd427710a2b8c8043983412e9
# æŸ¥çœ‹ä¸»æœºçŠ¶æ€
[root@parak khighness]# docker stats
CONTAINER ID    NAME   CPU %   MEM USAGE/LIMIT  MEM %     NET I/O    BLOCK I/O      PIDS
51441d9abfb9    es1   42.74%  495.6MiB/972.4MiB 50.97%    656B/0B   4.76GB/629MB     46

# åœæ­¢es1
$ docker stop es1
# åˆ é™¤es1
$ docker rm es1

# é™åˆ¶å†…å­˜ï¼Œå¯åŠ¨ES
$ docker run -d --name es1 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m" elasticsearch:7.6.2

# é‡æ–°å¯åŠ¨es1
[root@parak khighness]# docker run -d --name es1 -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m" elasticsearch:7.6.2
ca4494f52e5642d5992c49816b636b1858f2e2f5c1aaf38621c76001262e8e4d
# å†æ¬¡æŸ¥çœ‹çŠ¶æ€
[root@parak khighness]# docker stats
CONTAINER ID    NAME   CPU %   MEM USAGE/LIMIT   MEM %     NET I/O   BLOCK I/O       PIDS
ca4494f52e56    es1    0.68%   357.5MiB/972.4MiB 36.77%    737B/0B   476MB/1.78MB     45
# æµ‹è¯•è®¿é—®
[root@parak khighness]# curl localhost:9200
&#123;
  "name" : "ca4494f52e56",
  "cluster_name" : "docker-cluster",
  "cluster_uuid" : "aDKZlZW_T7Ss3Dr0CXZQlQ",
  "version" : &#123;
    "number" : "7.6.2",
    "build_flavor" : "default",
    "build_type" : "docker",
    "build_hash" : "ef48eb35cf30adf4db14086e8aabd07ef6fb113f",
    "build_date" : "2020-03-26T06:34:37.794943Z",
    "build_snapshot" : false,
    "lucene_version" : "8.4.0",
    "minimum_wire_compatibility_version" : "6.8.0",
    "minimum_index_compatibility_version" : "6.0.0-beta1"
  &#125;,
  "tagline" : "You Know, for Search"
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸ“ˆå¯è§†åŒ–"><a href="#ğŸ“ˆå¯è§†åŒ–" class="headerlink" title="ğŸ“ˆå¯è§†åŒ–"></a>ğŸ“ˆå¯è§†åŒ–</h2><p>Y1S1å¯è§†åŒ–é¢æ¿çš„å‰ç«¯å†™çš„çœŸå¥½çœ‹ï¼Œæˆ‘çˆ±äº†ã€‚</p>
<pre class="line-numbers language-shell"><code class="language-shell"># å®‰è£…è¿è¡Œ
$ docker run -d -p 8088:9000 --name=pt --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>è®¿é—®æµ‹è¯• <a target="_blank" rel="noopener" href="http://192.168.117.155:8088/">http://192.168.117.155:8088/</a></p>
</blockquote>
<img src="Docker/image-20201205232646075.png" alt="image-20201205232646075"  />

<img src="Docker/image-20201206105337297.png" alt="image-20201206105337297"  />





<h2 id="ğŸ“‘DockerFile"><a href="#ğŸ“‘DockerFile" class="headerlink" title="ğŸ“‘DockerFile"></a>ğŸ“‘DockerFile</h2><p>DockerFileå°±æ˜¯ç”¨æ¥æ„å»ºdockeré•œåƒçš„æ„å»ºæ–‡ä»¶-å‘½ä»¤è„šæœ¬ã€‚</p>
<blockquote>
<p>å‘½ä»¤</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">å‘½ä»¤</th>
<th align="center">æè¿°</th>
<th align="center">ç†è§£</th>
</tr>
</thead>
<tbody><tr>
<td align="center">FROM</td>
<td align="center">æŒ‡å®šåŸºç¡€é•œåƒ</td>
<td align="center">å…¬å¸çš„çˆ¶å…¬å¸</td>
</tr>
<tr>
<td align="center">MAINTAINER</td>
<td align="center">æŒ‡å®šç»´æŠ¤è€…ä¿¡æ¯</td>
<td align="center">å…¬å¸æ³¨å†Œä¿¡æ¯</td>
</tr>
<tr>
<td align="center">RUN</td>
<td align="center">æŠŠå‘½ä»¤å‰é¢åŠ ä¸ŠRUNå³å¯</td>
<td align="center">å…¬å¸æ³¨å†Œæµç¨‹</td>
</tr>
<tr>
<td align="center">ADD</td>
<td align="center">COPYæ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨è§£å‹</td>
<td align="center">å…¬å¸æ³¨å†Œèµ„é‡‘</td>
</tr>
<tr>
<td align="center">WORKDIR</td>
<td align="center">è®¾ç½®å½“å‰å·¥ä½œç›®å½•</td>
<td align="center">å…¬å¸å¤§æ¥¼ä»“åº“</td>
</tr>
<tr>
<td align="center">VOLUMN</td>
<td align="center">æŒ‚è½½ä¸»æœºç›®å½•</td>
<td align="center">å…¬å¸çš„ä¸»ä»“åº“</td>
</tr>
<tr>
<td align="center">EXPOSE</td>
<td align="center">æŒ‡å®šå¯¹å¤–ç«¯å£</td>
<td align="center">å…¬å¸å¼€æ”¾å¤§é—¨</td>
</tr>
<tr>
<td align="center">RUN</td>
<td align="center">è¿›ç¨‹è¦ä¸€ç›´è¿è¡Œä¸‹å»</td>
<td align="center">å…¬å¸æ°¸ä¸å€’é—­</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">å‘½ä»¤</th>
<th align="center">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="center">CMD</td>
<td align="center">æŒ‡å®šè¿™å®¹å™¨å¯åŠ¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤åªæœ‰æœ€åä¸€ä¸ªä¼šç”Ÿæ•ˆï¼Œå¯è¢«æ›¿ä»£ã€‚</td>
</tr>
<tr>
<td align="center">ENTRYPOINT</td>
<td align="center">æŒ‡å®šè¿™ä¸ªå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤ã€‚</td>
</tr>
<tr>
<td align="center">ONBUILD</td>
<td align="center">å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿DockerFileè¿™å°±ä¼šè¿è¡ŒONBUILDæŒ‡ä»¤ã€‚è§¦å‘æŒ‡ä»¤.</td>
</tr>
<tr>
<td align="center">COPY</td>
<td align="center">ç±»ä¼¼ADDï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­ã€‚</td>
</tr>
<tr>
<td align="center">ENV</td>
<td align="center">æ„å»ºçš„æ—¶å€™è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</td>
</tr>
</tbody></table>
<blockquote>
<p>å®ä¾‹1-æµ‹è¯•</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@parak home]# mkdir volume
[root@parak home]# cd volume/
[root@parak volume]# vim dockerfile1
[root@parak volume]# cat dockerfile1 
FROM centos
VOLUME ["volume01","volume02"]
CMD echo "---end---"
CMD /bin/bash
[root@parak volume]# docker build -f /home/volume/dockerfile1 -t khighness/centos:1.0 .
Sending build context to Docker daemon  2.048kB
Step 1/4 : FROM centos
 ---> 0d120b6ccaa8
Step 2/4 : VOLUME ["volume01","volume02"]
 ---> Running in 79dc7b449286
Removing intermediate container 79dc7b449286
 ---> 9a6608557c9a
Step 3/4 : CMD echo "---end---"
 ---> Running in 8b8c40056f99
Removing intermediate container 8b8c40056f99
 ---> 2158b18dedff
Step 4/4 : CMD /bin/bash
 ---> Running in 9d76c3598d69
Removing intermediate container 9d76c3598d69
 ---> 240a84cdfbef
Successfully built 240a84cdfbef
Successfully tagged khighness/centos:1.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>å®ä¾‹2-æ„å»ºè‡ªå·±çš„centos</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># 1ã€ç¼–å†™DockerFileæ–‡ä»¶
[root@parak dockerfile]# vim mydockerfile-centos
[root@parak dockerfile]# cat mydockerfile-centos 
FROM centos
MAINTAINER khighness<1823676372@qq.com>

ENV MYPATH /usr/local
WORKDIR $MYPATH 

RUN yum -y install vim
RUN yum -y install net-tools

EXPOSE 80

CMD echo $MYPATH
CMD echo "---end---"
CMD /bin/bash

# 2ã€é€šè¿‡DockerFileæ„å»ºé•œåƒ
[root@parak dockerfile]# docker build -f mydockerfile-centos  -t mycentos:1.0 .
Sending build context to Docker daemon  2.048kB
Step 1/10 : FROM centos
 ---> 0d120b6ccaa8
Step 2/10 : MAINTAINER khighness<1823676372@qq.com>
 ---> Running in 024da1b1d4cc
Removing intermediate container 024da1b1d4cc
 ---> 6c9b636504d2
Step 3/10 : ENV MYPATH /usr/local
 ---> Running in 4046d4e257ac
Removing intermediate container 4046d4e257ac
 ---> a5710fdc760e
Step 4/10 : WORKDIR $MYPATH
 ---> Running in 252416d49e94
Removing intermediate container 252416d49e94
 ---> fdbae7da4ca4
Step 5/10 : RUN yum -y install vim
 ---> Running in 9eb786294022
CentOS-8 - AppStream                            288 kB/s | 6.2 MB     00:22    
CentOS-8 - Base                                 703 kB/s | 2.3 MB     00:03    
CentOS-8 - Extras                               1.3 kB/s | 8.1 kB     00:06    
Dependencies resolved.
================================================================================
 Package             Arch        Version                   Repository      Size
================================================================================
Installing:
 vim-enhanced        x86_64      2:8.0.1763-15.el8         AppStream      1.4 M
Installing dependencies:
 gpm-libs            x86_64      1.20.7-15.el8             AppStream       39 k
 vim-common          x86_64      2:8.0.1763-15.el8         AppStream      6.3 M
 vim-filesystem      noarch      2:8.0.1763-15.el8         AppStream       48 k
 which               x86_64      2.21-12.el8               BaseOS          49 k

Transaction Summary
================================================================================
Install  5 Packages

Total download size: 7.8 M
Installed size: 30 M
Downloading Packages:
(1/5): gpm-libs-1.20.7-15.el8.x86_64.rpm        340 kB/s |  39 kB     00:00    
(2/5): vim-filesystem-8.0.1763-15.el8.noarch.rp 664 kB/s |  48 kB     00:00    
(3/5): which-2.21-12.el8.x86_64.rpm             315 kB/s |  49 kB     00:00    
(4/5): vim-enhanced-8.0.1763-15.el8.x86_64.rpm  543 kB/s | 1.4 MB     00:02    
(5/5): vim-common-8.0.1763-15.el8.x86_64.rpm    387 kB/s | 6.3 MB     00:16    
--------------------------------------------------------------------------------
Total                                           448 kB/s | 7.8 MB     00:17     
warning: /var/cache/dnf/AppStream-02e86d1c976ab532/packages/gpm-libs-1.20.7-15.el8.x86_64.rpm: Header V3 RSA/SHA256 Signature, key ID 8483c65d: NOKEY
CentOS-8 - AppStream                            1.6 MB/s | 1.6 kB     00:00    
Importing GPG key 0x8483C65D:
 Userid     : "CentOS (CentOS Official Signing Key) <security@centos.org>"
 Fingerprint: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D
 From       : /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial
Key imported successfully
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : which-2.21-12.el8.x86_64                               1/5 
  Installing       : vim-filesystem-2:8.0.1763-15.el8.noarch                2/5 
  Installing       : vim-common-2:8.0.1763-15.el8.x86_64                    3/5 
  Installing       : gpm-libs-1.20.7-15.el8.x86_64                          4/5 
  Running scriptlet: gpm-libs-1.20.7-15.el8.x86_64                          4/5 
  Installing       : vim-enhanced-2:8.0.1763-15.el8.x86_64                  5/5 
  Running scriptlet: vim-enhanced-2:8.0.1763-15.el8.x86_64                  5/5 
  Running scriptlet: vim-common-2:8.0.1763-15.el8.x86_64                    5/5 
  Verifying        : gpm-libs-1.20.7-15.el8.x86_64                          1/5 
  Verifying        : vim-common-2:8.0.1763-15.el8.x86_64                    2/5 
  Verifying        : vim-enhanced-2:8.0.1763-15.el8.x86_64                  3/5 
  Verifying        : vim-filesystem-2:8.0.1763-15.el8.noarch                4/5 
  Verifying        : which-2.21-12.el8.x86_64                               5/5 

Installed:
  gpm-libs-1.20.7-15.el8.x86_64         vim-common-2:8.0.1763-15.el8.x86_64    
  vim-enhanced-2:8.0.1763-15.el8.x86_64 vim-filesystem-2:8.0.1763-15.el8.noarch
  which-2.21-12.el8.x86_64             

Complete!
Removing intermediate container 9eb786294022
 ---> 491907dac3e2
Step 6/10 : RUN yum -y install net-tools
 ---> Running in 3a13d71952e5
Last metadata expiration check: 0:00:24 ago on Mon Dec  7 11:45:38 2020.
Dependencies resolved.
================================================================================
 Package         Architecture Version                        Repository    Size
================================================================================
Installing:
 net-tools       x86_64       2.0-0.52.20160912git.el8       BaseOS       322 k

Transaction Summary
================================================================================
Install  1 Package

Total download size: 322 k
Installed size: 942 k
Downloading Packages:
net-tools-2.0-0.52.20160912git.el8.x86_64.rpm   1.0 MB/s | 322 kB     00:00    
--------------------------------------------------------------------------------
Total                                           141 kB/s | 322 kB     00:02     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 
  Running scriptlet: net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 
  Verifying        : net-tools-2.0-0.52.20160912git.el8.x86_64              1/1 

Installed:
  net-tools-2.0-0.52.20160912git.el8.x86_64                                     

Complete!
Removing intermediate container 3a13d71952e5
 ---> 0d095f331d4a
Step 7/10 : EXPOSE 80
 ---> Running in 66d8aceea20c
Removing intermediate container 66d8aceea20c
 ---> a86402c5f9b7
Step 8/10 : CMD echo $MYPATH
 ---> Running in b6af3ea8ff6a
Removing intermediate container b6af3ea8ff6a
 ---> 17533352607f
Step 9/10 : CMD echo "---end---"
 ---> Running in f015d24c9277
Removing intermediate container f015d24c9277
 ---> cf7d78851a04
Step 10/10 : CMD /bin/bash
 ---> Running in d0f70eaa39ec
Removing intermediate container d0f70eaa39ec
 ---> d59930f07e43
Successfully built d59930f07e43
Successfully tagged mycentos:1.0


# 3ã€æµ‹è¯•è¿è¡Œï¼Œå®˜æ–¹çš„centosé•œåƒä¸­æ˜¯æ²¡æœ‰ç½‘ç»œå‘½ä»¤å’ŒVIMå‘½ä»¤çš„ï¼Œè€Œè‡ªå·±æ„å»ºçš„centosä¸­å·²ç»æœ‰
[root@parak dockerfile]# docker run -it --name=mycen mycentos:1.0 
[root@43b0b7eb76d8 local]# pwd
/usr/local
[root@43b0b7eb76d8 local]# vim test
[root@43b0b7eb76d8 local]# cat test 
Khighness
[root@43b0b7eb76d8 local]# ifconfig
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 172.17.0.4  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:ac:11:00:04  txqueuelen 0  (Ethernet)
        RX packets 8  bytes 656 (656.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0    
[root@43b0b7eb76d8 local]# exit
exit

# 4ã€æŸ¥çœ‹é•œåƒçš„å˜æ›´å†å²
[root@parak dockerfile]# docker history mycentos:1.0 
IMAGE               CREATED             CREATED BY                                      SIZE                COMMENT
d59930f07e43        23 minutes ago      /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "/binâ€¦   0B          
cf7d78851a04        23 minutes ago      /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echoâ€¦   0B               
17533352607f        23 minutes ago      /bin/sh -c #(nop)  CMD ["/bin/sh" "-c" "echoâ€¦   0B                  
a86402c5f9b7        23 minutes ago      /bin/sh -c #(nop)  EXPOSE 80                    0B                  
0d095f331d4a        23 minutes ago      /bin/sh -c yum -y install net-tools             23.2MB              
491907dac3e2        23 minutes ago      /bin/sh -c yum -y install vim                   57.7MB              
fdbae7da4ca4        24 minutes ago      /bin/sh -c #(nop) WORKDIR /usr/local            0B                  
a5710fdc760e        24 minutes ago      /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B                  
6c9b636504d2        24 minutes ago      /bin/sh -c #(nop)  MAINTAINER khighness<1823â€¦   0B                  
0d120b6ccaa8        3 months ago        /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B                  
<missing>           3 months ago        /bin/sh -c #(nop)  LABEL org.label-schema.scâ€¦   0B                  
<missing>           3 months ago        /bin/sh -c #(nop) ADD file:538afc0c5c964ce0dâ€¦   215MB         <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>CMDå’ŒENTRYPOINTçš„åŒºåˆ«</p>
</blockquote>
<p><strong>æµ‹è¯•CMD</strong></p>
<pre class="line-numbers language-shell"><code class="language-shell"># ç¼–å†™æµ‹è¯•CMDçš„dockerfile
[root@parak dockerfile]# vim dockerfile-cmd-test1
# å†…å®¹å°±æ˜¯ä¸€ä¸ªCMDå‘½ä»¤
[root@parak dockerfile]# cat dockerfile-cmd-test1 
FROM centos
CMD ["ls","-a"]
# æ„å»ºé•œåƒ
[root@parak dockerfile]# docker build -f dockerfile-cmd-test1 -t cmdtest .
Sending build context to Docker daemon  3.072kB
Step 1/2 : FROM centos
 ---> 0d120b6ccaa8
Step 2/2 : CMD ["ls","-a"]
 ---> Running in e4df49ad7ca4
Removing intermediate container e4df49ad7ca4
 ---> 4be395747805
Successfully built 4be395747805
Successfully tagged cmdtest:latest
# è¿è¡Œé•œåƒå°±ç›¸å½“äºè¿è¡ŒCMDå‘½ä»¤ï¼šls -a
[root@parak dockerfile]# docker run cmdtest
.
..
.dockerenv
bin
dev
etc
home
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
# è¿½åŠ å‘½ä»¤-lï¼Œå³ls -al
[root@parak dockerfile]# docker run cmdtest -l
docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused "exec: \"-l\": executable file not found in $PATH": unknown.

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>æµ‹è¯•ENTRYPOINT</strong></p>
<pre class="line-numbers language-shell"><code class="language-shell"># ç¼–å†™æµ‹è¯•ENTRYPOINTçš„dockerfile
[root@parak dockerfile]# vim dockerfile-entrypoint-test1
# å†…å®¹å°±æ˜¯ä¸€ä¸ªENTRYPOINTå‘½ä»¤
[root@parak dockerfile]# cat dockerfile-entrypoint-test1 
FROM centos
ENTRYPOINT ["ls", "-a"]
# æ„å»ºé•œåƒ
[root@parak dockerfile]# docker build -f dockerfile-entrypoint-test1 -t entrypointtest .
Sending build context to Docker daemon  4.096kB
Step 1/2 : FROM centos
 ---> 0d120b6ccaa8
Step 2/2 : ENTRYPOINT ["ls", "-a"]
 ---> Running in 0aa9b4c97293
Removing intermediate container 0aa9b4c97293
 ---> 472d86e826d8
Successfully built 472d86e826d8
Successfully tagged entrypointtest:latest
# è¿è¡Œé•œåƒ
[root@parak dockerfile]# docker run entrypointtest
.
..
.dockerenv
bin
dev
etc
home
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
# è¿½å‡»å‘½ä»¤-lï¼Œå³ls -al
[root@parak dockerfile]# docker run entrypointtest -l
total 0
drwxr-xr-x.   1 root root   6 Dec  7 12:27 .
drwxr-xr-x.   1 root root   6 Dec  7 12:27 ..
-rwxr-xr-x.   1 root root   0 Dec  7 12:27 .dockerenv
lrwxrwxrwx.   1 root root   7 May 11  2019 bin -> usr/bin
drwxr-xr-x.   5 root root 340 Dec  7 12:27 dev
drwxr-xr-x.   1 root root  66 Dec  7 12:27 etc
drwxr-xr-x.   2 root root   6 May 11  2019 home
lrwxrwxrwx.   1 root root   7 May 11  2019 lib -> usr/lib
lrwxrwxrwx.   1 root root   9 May 11  2019 lib64 -> usr/lib64
drwx------.   2 root root   6 Aug  9 21:40 lost+found
drwxr-xr-x.   2 root root   6 May 11  2019 media
drwxr-xr-x.   2 root root   6 May 11  2019 mnt
drwxr-xr-x.   2 root root   6 May 11  2019 opt
dr-xr-xr-x. 259 root root   0 Dec  7 12:27 proc
dr-xr-x---.   2 root root 162 Aug  9 21:40 root
drwxr-xr-x.  11 root root 163 Aug  9 21:40 run
lrwxrwxrwx.   1 root root   8 May 11  2019 sbin -> usr/sbin
drwxr-xr-x.   2 root root   6 May 11  2019 srv
dr-xr-xr-x.  13 root root   0 Dec  6 08:24 sys
drwxrwxrwt.   7 root root 145 Aug  9 21:40 tmp
drwxr-xr-x.  12 root root 144 Aug  9 21:40 usr
drwxr-xr-x.  20 root root 262 Aug  9 21:40 var<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>å®ä¾‹3-æ„å»ºè‡ªå·±çš„tomcat</p>
</blockquote>
<h2 id="ğŸ”é•œåƒ"><a href="#ğŸ”é•œåƒ" class="headerlink" title="ğŸ”é•œåƒ"></a>ğŸ”é•œåƒ</h2><blockquote>
<p>æ¦‚å¿µ</p>
</blockquote>
<p>é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼Œå®ƒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ã€‚</p>
<blockquote>
<p>UnionFS(è”åˆæ–‡ä»¶ç³»ç»Ÿ)</p>
</blockquote>
<p>UnionFS: è”åˆæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹(Unite several directions into a single virtual file system)ã€‚Unionæ–‡ä»¶ç³»ç»Ÿæ˜¯Dockeré•œåƒçš„åŸºç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒ(æ²¡æœ‰çˆ¶é•œåƒ)ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒã€‚</p>
<p>ç‰¹æ€§ï¼šä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•ã€‚</p>
<blockquote>
<p>Dockeré•œåƒåŠ è½½åŸç†</p>
</blockquote>
<p>Dockerçš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»ŸUnionFSã€‚</p>
<p>bootfs(boot file system)ä¸»è¦åŒ…å«bootloaderå’Œkernelï¼Œbootloaderä¸»è¦æ˜¯å¼•å¯¼åŠ è½½kernelï¼ŒLinuxåˆšå¯åŠ¨æ—¶ä¼šåœ¨å®¶bootfsæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨Dockeré•œåƒçš„æœ€åº•å±‚æ˜¯bootfsã€‚è¿™ä¸€å±‚ä¸æˆ‘ä»¬å…¸å‹çš„Linux/Unixç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å«bootåŠ è½½å™¨å’Œå†…æ ¸ã€‚å½“bootåŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸å°±éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶å†…å­˜å’Œä½¿ç”¨æƒå·²ç”±bootfsè½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½bootfsã€‚</p>
<p>rootfs(root file system)ï¼Œåœ¨bootfsä¹‹åã€‚åŒ…å«çš„å°±æ˜¯å…¸å‹Linuxç³»ç»Ÿ/devï¼Œ/procï¼Œ/binï¼Œ/etcç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶ã€‚rootfså°±æ˜¯å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntuã€CentOSç­‰ç­‰ã€‚</p>
<blockquote>
<p>commité•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker commit -m="<messahe>" -a="<author>" <Container ID/NAME> <Target>:<Tag>

# ä¾‹å¦‚ï¼Œæ”¹è£…tomcat:9.0çš„é•œåƒæ‰“åŒ…æˆè‡ªå·±çš„é•œåƒk-tom:1.0
[root@parak khighness]# docker commit -a="Khighness" -m="Add web application" tom1 k-tom:1.0
sha256:fa4617c8771c81b890dc2a87c7be1d2b851c6ba92b053d0d1d8730b2006550c5
[root@parak khighness]# docker images
REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
k-tom                 1.0                 fa4617c8771c        26 seconds ago      654MB
nginx                 latest              bc9a0695f571        11 days ago         133MB
tomcat                9.0                 e0bd8b34b4ea        2 weeks ago         649MB
redis                 latest              74d107221092        2 weeks ago         104MB
portainer/portainer   latest              62771b0b9b09        4 months ago        79.1MB
elasticsearch         7.6.2               f29a1ee41030        8 months ago        791MB
hello-world           latest              bf756fb1ae65        11 months ago       13.3kB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸŒ€å®¹å™¨æ•°æ®å·"><a href="#ğŸŒ€å®¹å™¨æ•°æ®å·" class="headerlink" title="ğŸŒ€å®¹å™¨æ•°æ®å·"></a>ğŸŒ€å®¹å™¨æ•°æ®å·</h2><blockquote>
<p>æ¦‚å¿µ</p>
</blockquote>
<p>ç›®å½•æŒ‚è½½ï¼Œå°†å®¹å™¨å†…çš„ç›®å½•æŒ‚è½½åœ¨CentOSä¸Š</p>
<ul>
<li>Dockerå®¹å™¨äº§ç”Ÿçš„æ•°æ®åŒæ­¥åˆ°å®¿ä¸»æœº</li>
<li>æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨ä¹‹é—´å…±äº«æˆ–é‡ç”¨æ•°æ®</li>
</ul>
<blockquote>
<p>å‘½ä»¤è¡ŒæŒ‚è½½</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ docker run -it -v -p <ä¸»æœºç›®å½•>:<å®¹å™¨ç›®å½•> 

# ä¾‹å¦‚ï¼Œå°†dockerçš„centoså®¹å™¨ç›®å½•/home/testä¸å®¿ä¸»centosçš„/home/testæŒ‚è½½èµ·æ¥
[root@parak khighness]# docker run -it --name=cen -v /home/test:/home/test centos  /bin/bash
Unable to find image 'centos:latest' locally
latest: Pulling from library/centos
3c72a8ed6814: Pull complete 
Digest: sha256:76d24f3ba3317fa945743bb3746fbaf3a0b752f10b10376960de01da70685fbd
Status: Downloaded newer image for centos:latest
[root@4410a5c86528 /]# ls
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
[root@4410a5c86528 /]# cd home/
[root@4410a5c86528 home]# ls
test
[khighness@parak ~]$ cd /home/
[khighness@parak home]$ ls
khighness  test
[root@parak home]# docker inspect cen
# å¦‚ä¸‹æ˜¯æŒ‚è½½ä¿¡æ¯
        "Mounts": [
            &#123;
                "Type": "bind",              # ç±»å‹ï¼šç»‘å®š
                "Source": "/home/test",      # å®¹å™¨ç›®å½•
                "Destination": "/home/test", # ä¸»æœºç›®å½•
                "Mode": "",
                "RW": true,
                "Propagation": "rprivate"
            &#125;
        ]
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨å®¹å™¨çš„æŒ‚è½½ç›®å½•ä¸‹æ–°å»ºK1.javaï¼Œåœ¨å®¿ä¸»æœºçš„æŒ‚è½½ç›®å½•ä¸­å¯ä»¥ç›´æ¥çœ‹åˆ°</p>
<img src="/posts/f5f9fa9b/image-20201206183841366.png" class="" title="image-20201206183841366">



<blockquote>
<p>å®‰è£…MySQL</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># ä¸‹è½½8.0.20ç‰ˆæœ¬çš„mysqlé•œåƒ
$ docker pull mysql:8.0.20
# å¯åŠ¨mysqlæœåŠ¡
# -d åå°è¿è¡Œ
# -v æŒ‚è½½é…ç½®å’Œæ•°æ®
# -e MYSQL_ROOT)PASSWORD è®¾ç½®å¯†ç 
$ docker run --name ksql -d -p 3306:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=KAG1823 mysql:8.0.20

# è§£å†³windowsçš„navicatæ— æ³•è¿æ¥çš„é—®é¢˜
# è¿›å…¥mysqlå®¢æˆ·ç«¯
$ docker exec -it ksql  bash
# ç™»å½•mysql
$ mysql -u root -pKAG1823
# é‡ç½®å¯†ç 
$ ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'KAG1823';<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸŒDockerç½‘ç»œ"><a href="#ğŸŒDockerç½‘ç»œ" class="headerlink" title="ğŸŒDockerç½‘ç»œ"></a>ğŸŒDockerç½‘ç»œ</h2><blockquote>
<p>å®ç°åŸç†</p>
</blockquote>
<p>Dockerä½¿ç”¨Linuxæ¡¥æ¥ï¼Œåœ¨å®¿ä¸»æœºè™šæ‹Ÿä¸€ä¸ªDockerå®¹å™¨ç½‘æ¡¥(Docker0)ï¼ŒDockerå¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶ä¼šæ ¹æ®Dockerç½‘æ¡¥çš„ç½‘æ®µåˆ†é…ç»™å®¹å™¨ä¸€ä¸ªIPåœ°å€ï¼Œç§°ä¸ºContainer-IPï¼ŒåŒæ—¶Dockerç½‘æ¡¥æ˜¯æ¯ä¸ªå®¹å™¨çš„é»˜è®¤ç½‘å…³ã€‚å› ä¸ºåœ¨åŒä¸€å®¿ä¸»æœºå†…çš„å®¹å™¨éƒ½æ¥å…¥åŒä¸€ç½‘æ¡¥ã€‚è¿™æ ·å®¹å™¨ä¹‹é—´å°±èƒ½å¤Ÿé€šè¿‡å®¹å™¨çš„Contain-IPç›´æ¥é€šä¿¡ã€‚</p>
<p>Dockerç½‘æ¡¥æ˜¯å®¿ä¸»æœºè™šæ‹Ÿå‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯çœŸå®å­˜åœ¨çš„ç½‘ç»œè®¾å¤‡ï¼Œå¤–éƒ¨è®¾å¤‡æ˜¯æ— æ³•å¯»å€åˆ°çš„ï¼Œè¿™ä¹Ÿæ„å‘³ç€å¤–éƒ¨è®¾å¤‡æ— æ³•é€šè¿‡ç›´æ¥Container-IPè®¿é—®åˆ°å®¹å™¨ã€‚å¦‚æœå®¹å™¨å¸Œæœ›å¤–éƒ¨è®¿é—®åˆ°ï¼Œå¯ä»¥é€šè¿‡æ˜ å°„å®¹å™¨ç«¯å£åˆ°å®¿ä¸»ä¸»æœºï¼ˆç«¯å£æ˜ å°„ï¼‰ï¼Œå³docker runåˆ›å»ºå®¹å™¨æ—¶å€™é€šè¿‡-pæˆ–è€…-På‚æ•°æ¥å¯åŠ¨ï¼Œè®¿é—®å®¹å™¨çš„æ—¶å€™å°±é€šè¿‡[å®¿ä¸»æœºIP]:[å®¹å™¨ç«¯å£]è®¿é—®å®¹å™¨ã€‚</p>
<blockquote>
<p>ç½‘ç»œæ¨¡å¼</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">æ¨¡å¼</th>
<th align="center">é…ç½®</th>
<th align="center">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Bridgeæ¨¡å¼</td>
<td align="center">-net=bridge</td>
<td align="center">é»˜è®¤æ¨¡å¼</td>
</tr>
<tr>
<td align="center">Hostæ¨¡å¼</td>
<td align="center">-net=host</td>
<td align="center">å®¹å™¨å’Œå®¿ä¸»æœºå…±äº«Network NameSpace</td>
</tr>
<tr>
<td align="center">Containeræ¨¡å¼</td>
<td align="center">-net=container : NAME OR ID</td>
<td align="center">å®¹å™¨å’Œå¦å¤–ä¸€ä¸ªå®¹å™¨å…±äº«Network NameSpace</td>
</tr>
<tr>
<td align="center">Noneæ¨¡å¼</td>
<td align="center">-net=none</td>
<td align="center">å®¹å™¨æœ‰ç‹¬ç«‹çš„Network NameSpaceï¼Œä½†å¹¶æ²¡æœ‰å¯¹å…¶è¿›è¡Œä»»ä½•ç½‘ç»œè®¾ç½®ï¼Œå¦‚åˆ†é…veth pair å’Œç½‘æ¡¥è¿æ¥ï¼Œé…ç½®IPç­‰</td>
</tr>
</tbody></table>
<h3 id="1ï¸âƒ£hostæ¨¡å¼"><a href="#1ï¸âƒ£hostæ¨¡å¼" class="headerlink" title="1ï¸âƒ£hostæ¨¡å¼"></a>1ï¸âƒ£hostæ¨¡å¼</h3><p>å¦‚æœå¯åŠ¨å®¹å™¨çš„æ—¶å€™ä½¿ç”¨hostæ¨¡å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°†ä¸ä¼šè·å¾—ä¸€ä¸ªç‹¬ç«‹çš„Network NameSpaceï¼Œè€Œæ˜¯å’Œå®¿ä¸»æœºå…±ç”¨ä¸€ä¸ªNetwork NameSpaceã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„IPç­‰ï¼Œè€Œæ˜¯ä½¿ç”¨å®¿ä¸»æœºçš„IPå’Œç«¯å£ã€‚ä½†æ˜¯ï¼Œå®¹å™¨çš„å…¶ä»–æ–¹é¢ï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯å’Œå®¿ä¸»æœºéš”ç¦»çš„ã€‚</p>
<p>ä½¿ç”¨hostæ¨¡å¼çš„å®¹å™¨å¯ä»¥ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„IPåœ°å€ä¸å¤–ç•Œé€šä¿¡ï¼Œå®¹å™¨å†…éƒ¨çš„æœåŠ¡ç«¯å£ä¹Ÿå¯ä»¥ä½¿ç”¨å®¿ä¸»æœºçš„ç«¯å£ï¼Œä¸éœ€è¦è¿›è¡ŒNATï¼Œhostæœ€å¤§çš„ä¼˜åŠ¿å°±æ˜¯ç½‘ç»œæ€§èƒ½æ¯”è¾ƒå¥½ï¼Œä½†æ˜¯docker hostä¸Šå·²ç»ä½¿ç”¨çš„ç«¯å£å°±ä¸èƒ½å†ç”¨äº†ï¼Œç½‘ç»œçš„éš”ç¦»æ€§ä¸å¥½ã€‚</p>
<h3 id="2ï¸âƒ£containeræ¨¡å¼"><a href="#2ï¸âƒ£containeræ¨¡å¼" class="headerlink" title="2ï¸âƒ£containeræ¨¡å¼"></a>2ï¸âƒ£containeræ¨¡å¼</h3><p>è¿™ä¸ªæ¨¡å¼æŒ‡å®šæ–°åˆ›å»ºçš„å®¹å™¨å’Œå·²ç»å­˜åœ¨çš„ä¸€ä¸ªå®¹å™¨å…±äº«ä¸€ä¸ª Network NameSpaceï¼Œè€Œä¸æ˜¯å’Œå®¿ä¸»æœºå…±äº«ã€‚æ–°åˆ›å»ºçš„å®¹å™¨ä¸ä¼šåˆ›å»ºè‡ªå·±çš„ç½‘å¡ï¼Œé…ç½®è‡ªå·±çš„ IPï¼Œè€Œæ˜¯å’Œä¸€ä¸ªæŒ‡å®šçš„å®¹å™¨å…±äº« IPã€ç«¯å£èŒƒå›´ç­‰ã€‚åŒæ ·ï¼Œä¸¤ä¸ªå®¹å™¨é™¤äº†ç½‘ç»œæ–¹é¢ï¼Œå…¶ä»–çš„å¦‚æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹åˆ—è¡¨ç­‰è¿˜æ˜¯éš”ç¦»çš„ã€‚ä¸¤ä¸ªå®¹å™¨çš„è¿›ç¨‹å¯ä»¥é€šè¿‡ lo ç½‘å¡è®¾å¤‡é€šä¿¡ã€‚</p>
<h3 id="3ï¸âƒ£noneæ¨¡å¼"><a href="#3ï¸âƒ£noneæ¨¡å¼" class="headerlink" title="3ï¸âƒ£noneæ¨¡å¼"></a>3ï¸âƒ£noneæ¨¡å¼</h3><p>ä½¿ç”¨noneæ¨¡å¼ï¼ŒDockerå®¹å™¨æ‹¥æœ‰è‡ªå·±çš„Network NameSpaceï¼Œä½†æ˜¯ï¼Œå¹¶ä¸ä¸ºDockerå®¹å™¨è¿›è¡Œä»»ä½•ç½‘ç»œé…ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªDockerå®¹å™¨æ²¡æœ‰ç½‘å¡ã€IPã€è·¯ç”±ç­‰ä¿¡æ¯ã€‚éœ€è¦æˆ‘ä»¬è‡ªå·±ä¸ºDockerå®¹å™¨æ·»åŠ ç½‘å¡ã€é…ç½®IPç­‰ã€‚</p>
<p>è¿™ç§ç½‘ç»œæ¨¡å¼ä¸‹å®¹å™¨åªæœ‰loå›ç¯ç½‘ç»œï¼Œæ²¡æœ‰å…¶ä»–ç½‘å¡ã€‚noneæ¨¡å¼å¯ä»¥åœ¨å®¹å™¨åˆ›å»ºæ—¶é€šè¿‡â€“network=noneæ¥æŒ‡å®šã€‚è¿™ç§ç±»å‹çš„ç½‘ç»œæ²¡æœ‰åŠæ³•è”ç½‘ï¼Œå°é—­çš„ç½‘ç»œèƒ½å¾ˆå¥½çš„ä¿è¯å®¹å™¨çš„å®‰å…¨æ€§ã€‚</p>
<h3 id="4ï¸âƒ£bridgeæ¨¡å¼"><a href="#4ï¸âƒ£bridgeæ¨¡å¼" class="headerlink" title="4ï¸âƒ£bridgeæ¨¡å¼"></a>4ï¸âƒ£bridgeæ¨¡å¼</h3><p>å½“Dockerè¿›ç¨‹å¯åŠ¨æ—¶ï¼Œä¼šåœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€ä¸ªåä¸ºdocker0çš„è™šæ‹Ÿç½‘æ¡¥ï¼Œæ­¤ä¸»æœºä¸Šå¯åŠ¨çš„Dockerå®¹å™¨ä¼šè¿æ¥åˆ°è¿™ä¸ªè™šæ‹Ÿç½‘æ¡¥ä¸Šã€‚è™šæ‹Ÿç½‘æ¡¥çš„å·¥ä½œæ–¹å¼å’Œç‰©ç†äº¤æ¢æœºç±»ä¼¼ï¼Œè¿™æ ·ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨å°±é€šè¿‡äº¤æ¢æœºè¿åœ¨äº†ä¸€ä¸ªäºŒå±‚ç½‘ç»œä¸­ã€‚</p>
<p>ä»docker0å­ç½‘ä¸­åˆ†é…ä¸€ä¸ªIPç»™å®¹å™¨ä½¿ç”¨ï¼Œå¹¶è®¾ç½®docker0çš„IPåœ°å€ä¸ºå®¹å™¨çš„é»˜è®¤ç½‘å…³ã€‚åœ¨ä¸»æœºä¸Šåˆ›å»ºä¸€å¯¹è™šæ‹Ÿç½‘å¡veth pairè®¾å¤‡ï¼ŒDockerå°†veth pairè®¾å¤‡çš„ä¸€ç«¯æ”¾åœ¨æ–°åˆ›å»ºçš„å®¹å™¨ä¸­ï¼Œå¹¶å‘½åä¸ºeth0ï¼ˆå®¹å™¨çš„ç½‘å¡ï¼‰ï¼Œå¦ä¸€ç«¯æ”¾åœ¨ä¸»æœºä¸­ï¼Œä»¥vethxxxè¿™æ ·ç±»ä¼¼çš„åå­—å‘½åï¼Œå¹¶å°†è¿™ä¸ªç½‘ç»œè®¾å¤‡åŠ å…¥åˆ°docker0ç½‘æ¡¥ä¸­ã€‚å¯ä»¥é€šè¿‡brctl showå‘½ä»¤æŸ¥çœ‹ã€‚</p>
<p>bridgeæ¨¡å¼æ˜¯dockerçš„é»˜è®¤ç½‘ç»œæ¨¡å¼ï¼Œä¸å†™â€“netå‚æ•°ï¼Œå°±æ˜¯bridgeæ¨¡å¼ã€‚ä½¿ç”¨docker run -pæ—¶ï¼Œdockerå®é™…æ˜¯åœ¨iptablesåšäº†DNATè§„åˆ™ï¼Œå®ç°ç«¯å£è½¬å‘åŠŸèƒ½ã€‚å¯ä»¥ä½¿ç”¨iptables -t nat -vnLæŸ¥çœ‹ã€‚</p>
<blockquote>
<p>â€“linkæ¢ç©¶</p>
</blockquote>
<p>å®˜æ–¹å·²ç»ä¸æ¨èä½¿ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£ä¸€ä¸‹ã€‚</p>
<p>2ä¸ªå®¹å™¨ä¹‹é—´äº’ç›¸è®¿é—®é€šä¿¡ï¼š<code>docker run &lt;container1-id/name&gt; --link &lt;container2-id/name&gt; &lt;image&gt;</code></p>
<p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¯åŠ¨å®¹å™¨2çš„æ—¶å€™ï¼Œå®¹å™¨ä¾¿å¯ä»¥pingé€šå®¹å™¨1ï¼Œä½†æ˜¯åå‘pingä¸é€šã€‚</p>
<pre class="line-numbers language-shell"><code class="language-shell"># åˆ›å»ºå®¹å™¨tom1
[root@parak khighness]# docker run -d -p 3356:8080 --name tom1 tomcat:9.0 
dd615d6d2ccb9467aad8ba008ece995588680d849b9f61945b10de5c3475f671
# ä½¿ç”¨--linkåˆ›å»ºå®¹å™¨2
[root@parak khighness]# docker run -d -p 3357:8081 --name tom2 --link tom1  tomcat:9.0 
b2c17969a2cb4407bb1a61a53703a38998a11db01ce516feb70e397b42af6ad3
# tom1ä¸èƒ½pingé€štom2
[root@parak khighness]# docker exec -it tom1 ping tom2
ping: tom2: Name or service not known
# tom2å¯ä»¥pingé€štom1
[root@parak khighness]# docker exec -it tom2 ping tom1
PING tom1 (172.17.0.4) 56(84) bytes of data.
64 bytes from tom1 (172.17.0.4): icmp_seq=1 ttl=64 time=0.161 ms
64 bytes from tom1 (172.17.0.4): icmp_seq=2 ttl=64 time=0.108 ms
64 bytes from tom1 (172.17.0.4): icmp_seq=3 ttl=64 time=0.122 ms
^C
--- tom1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 4ms
rtt min/avg/max/mdev = 0.108/0.130/0.161/0.024 ms
# æŸ¥çœ‹tom2å†…éƒ¨çš„hostsæ–‡ä»¶
[root@parak khighness]# docker exec -it tom2 cat /etc/hosts
127.0.0.1    localhost
::1    localhost ip6-localhost ip6-loopback
fe00::0    ip6-localnet
ff00::0    ip6-mcastprefix
ff02::1    ip6-allnodes
ff02::2    ip6-allrouters
172.17.0.4    tom1 dd615d6d2ccb # ==> æ ¹æºï¼šæœ¬è´¨å°±æ˜¯tom2å°±æ˜¯åœ¨æœ¬åœ°é…ç½®äº†tom1çš„åŸŸåIPè§£æã€‚
172.17.0.5    b2c17969a2cb<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è‡ªå®šä¹‰ç½‘ç»œ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># åˆ›å»ºç½‘ç»œ
[root@parak khighness]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet
abaebdc493149a140ee77965274885adea3882bf117c4f8e61e4034730c3b890
# æŸ¥çœ‹ç½‘ç»œ
[root@parak khighness]# docker network ls
NETWORK ID          NAME                DRIVER              SCOPE
4399361ba4a9        bridge              bridge              local
65f0ec2bfb42        host                host                local
abaebdc49314        mynet               bridge              local
feab1dfce431        none                null                local
# è¯¦ç»†ä¿¡æ¯
[root@parak khighness]# docker network inspect mynet 
[
    &#123;
        "Name": "mynet",
        "Id": "abaebdc493149a140ee77965274885adea3882bf117c4f8e61e4034730c3b890",
        "Created": "2020-12-10T16:12:08.563828418+08:00",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": &#123;
            "Driver": "default",
            "Options": &#123;&#125;,
            "Config": [
                &#123;
                    "Subnet": "192.168.0.0/16",
                    "Gateway": "192.168.0.1"
                &#125;
            ]
        &#125;,
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": &#123;
            "Network": ""
        &#125;,
        "ConfigOnly": false,
        "Containers": &#123;&#125;,
        "Options": &#123;&#125;,
        "Labels": &#123;&#125;
    &#125;
]
# åœ¨mynetä¸‹å¯åŠ¨tomcat1
[root@parak khighness]# docker run -d -it -p 8080:3355 --net mynet --name mynet-tom1 tomcat:9.0 
4d799757f01f560af7fd44d610b7fdabd1e0f66ef528bf1259f09242bddbb636
# åœ¨mynetä¸‹å¯åŠ¨tomcat2
[root@parak khighness]# docker run -d -it -p 8081:3356 --net mynet --name mynet-tom2 tomcat:9.0 
15c045f96d5b7b2ee2e470cb69e5b1f86511929f7ed05ed8f20db26ef4b975af
# ä½¿ç”¨mynet-tom2 ping mynet-tom1
[root@parak khighness]# docker exec -it mynet-tom2 ping mynet-tom1
PING mynet-tom1 (192.168.0.2) 56(84) bytes of data.
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.068 ms
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.042 ms
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=3 ttl=64 time=0.055 ms
--- mynet-tom1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 4ms
rtt min/avg/max/mdev = 0.042/0.055/0.068/0.010 ms
# ä½¿ç”¨mynet-tom1 ping mynet-tom2
[root@parak khighness]# docker exec -it mynet-tom1 ping mynet-tom2
PING mynet-tom2 (192.168.0.3) 56(84) bytes of data.
64 bytes from mynet-tom2.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.036 ms
64 bytes from mynet-tom2.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.048 ms
64 bytes from mynet-tom2.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.058 ms
--- mynet-tom2 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2ms
rtt min/avg/max/mdev = 0.036/0.047/0.058/0.010 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>è‡ªå®šä¹‰ç½‘ç»œè‡ªåŠ¨ç»´æŠ¤å¥½å®¹å™¨çš„ç½‘ç»œå…³ç³»ï¼</p>
<blockquote>
<p>ç½‘ç»œè¿é€š</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># åœ¨Docker0ç½‘ç»œå¯åŠ¨tomcat
[root@parak khighness]# docker run -d -it -p 8082:3357 --name tom1 tomcat:9.0 
0344f04baab2eaeaac0118dac7a93d8b2d77946636c76ed3bde804cbeda836be
# æµ‹è¯•tom1 ping mynetâ€”tom1
[root@parak khighness]# docker exec tom1 ping mynet-tom1
ping: mynet-tom1: Name or service not known
# è¿é€šmynet - tom1
[root@parak khighness]# docker network connect mynet tom1 
# æŸ¥çœ‹mynet1çš„è¯¦ç»†ä¿¡æ¯
[root@parak khighness]# docker inspect mynet
[
    &#123;
        "Name": "mynet",
        "Id": "abaebdc493149a140ee77965274885adea3882bf117c4f8e61e4034730c3b890",
        "Created": "2020-12-10T16:12:08.563828418+08:00",
        "Scope": "local",
        "Driver": "bridge",
        "EnableIPv6": false,
        "IPAM": &#123;
            "Driver": "default",
            "Options": &#123;&#125;,
            "Config": [
                &#123;
                    "Subnet": "192.168.0.0/16",
                    "Gateway": "192.168.0.1"
                &#125;
            ]
        &#125;,
        "Internal": false,
        "Attachable": false,
        "Ingress": false,
        "ConfigFrom": &#123;
            "Network": ""
        &#125;,
        "ConfigOnly": false,
        "Containers": &#123;
            # å‘ç°mynetå°†tom1æ”¾åˆ°äº†mynetç½‘ç»œä¸‹ï¼Œå³ä¸€ä¸ªå®¹å™¨ï¼Œä¸¤ä¸ªIP
            "0344f04baab2eaeaac0118dac7a93d8b2d77946636c76ed3bde804cbeda836be": &#123;
                "Name": "tom1",
                "EndpointID": "8911ad05a9b0d7d0effbf50c82659f36b82d21e18f992359b09494073dddd969",
                "MacAddress": "02:42:c0:a8:00:04",
                "IPv4Address": "192.168.0.4/16",
                "IPv6Address": ""
            &#125;,
            "15c045f96d5b7b2ee2e470cb69e5b1f86511929f7ed05ed8f20db26ef4b975af": &#123;
                "Name": "mynet-tom2",
                "EndpointID": "907f16284e90be0d880a999b29210d1cd82adb2c79b4179eeb1d70d75130362a",
                "MacAddress": "02:42:c0:a8:00:03",
                "IPv4Address": "192.168.0.3/16",
                "IPv6Address": ""
            &#125;,
            "4d799757f01f560af7fd44d610b7fdabd1e0f66ef528bf1259f09242bddbb636": &#123;
                "Name": "mynet-tom1",
                "EndpointID": "6529ef4fc05dffe65fe875fdf15f2f4a61665c4d969767db94dd828baf88b323",
                "MacAddress": "02:42:c0:a8:00:02",
                "IPv4Address": "192.168.0.2/16",
                "IPv6Address": ""
            &#125;
        &#125;,
        "Options": &#123;&#125;,
        "Labels": &#123;&#125;
    &#125;
]
# å†æ¬¡æµ‹è¯•tom1 ping mynetâ€”tom1
[root@parak khighness]# docker exec -it tom1 ping mynet-tom1
PING mynet-tom1 (192.168.0.2) 56(84) bytes of data.
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.097 ms
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.052 ms
64 bytes from mynet-tom1.mynet (192.168.0.2): icmp_seq=3 ttl=64 time=0.053 ms
--- mynet-tom1 ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 3ms
rtt min/avg/max/mdev = 0.052/0.067/0.097/0.022 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸ’ Redisé›†ç¾¤éƒ¨ç½²"><a href="#ğŸ’ Redisé›†ç¾¤éƒ¨ç½²" class="headerlink" title="ğŸ’ Redisé›†ç¾¤éƒ¨ç½²"></a>ğŸ’ Redisé›†ç¾¤éƒ¨ç½²</h2><blockquote>
<p>shellè„šæœ¬</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell"># åˆ›å»ºç½‘å¡
docker network create redis --subnet 172.38.0.0/16

# é€šè¿‡è„šæœ¬åˆ›å»ºå…­ä¸ªredisé…ç½®
for port in $(seq 1 6); \
do \
mkdir -p /mydata/redis/node-$&#123;port&#125;/conf
touch /mydata/redis/node-$&#123;port&#125;/conf/redis.conf
cat << EOF >>/mydata/redis/node-$&#123;port&#125;/conf/redis.conf
port 6379
bind 0.0.0.0
cluster-enabled yes
cluster-config-file nodes.conf
cluster-node-timeout 5000
cluster-announce-ip 172.38.0.1$&#123;port&#125;
cluster-announce-port 6379
cluster-announce-bus-port 16379
appendonly yes
EOF
done

# è¿è¡Œredis
for port in $(seq 1 6); \
do
docker run -p 637$&#123;port&#125;:6379 -p 1637$&#123;port&#125;:16379 --name redis-$&#123;port&#125; \
-v /mydata/redis/node-$&#123;port&#125;/data:/data \
-v /mydata/redis/node-$&#123;port&#125;/conf/redis.conf:/etc/redis/redis.conf \
-d --net redis --ip 172.38.0.1$&#123;port&#125; redis:5.0.9-alpine3.11 redis-server /etc/redis/redis.conf
done

# è¿›å…¥redis-1
docker exec -it redis-1 /bin/sh
# æ­å»ºé›†ç¾¤
redis-cli --cluster create 172.38.0.11:6379 172.38.0.12:6379 172.38.0.13:6379 172.38.0.14:6379 172.38.0.15:6379 172.38.0.16:6379 

# åœæ­¢é›†ç¾¤
for port in $(seq 1 6); \
do
docker stop redis-$&#123;port&#125; 
done

# å¯åŠ¨é›†ç¾¤
for port in $(seq 1 6); \
do 
docker start redis-$&#123;port&#125; 
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="ğŸ’¨SpringBootæµ‹è¯•"><a href="#ğŸ’¨SpringBootæµ‹è¯•" class="headerlink" title="ğŸ’¨SpringBootæµ‹è¯•"></a>ğŸ’¨SpringBootæµ‹è¯•</h2><blockquote>
<p>æ­¥éª¤</p>
</blockquote>
<ul>
<li>æ„å»ºSpringBooté¡¹ç›®</li>
<li>æ‰“åŒ…webåº”ç”¨</li>
<li>ç¼–å†™dockerfile</li>
<li>æ„å»ºé•œåƒ</li>
<li>å‘å¸ƒè¿è¡Œ</li>
</ul>
<blockquote>
<p>ç¼–å†™Controller</p>
</blockquote>
<pre class="line-numbers language-java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/hello/&amp;#123;name&amp;#125;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span> String name<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">"\n\n"</span> <span class="token operator">+</span> <span class="token string">" -from KHighness"</span><span class="token punctuation">;</span>
    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>é€šè¿‡mavençš„packageæ‰“åŒ…</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[INFO] Scanning for projects...
[INFO] 
[INFO] --------------------------< top.parak:hello >---------------------------
[INFO] Building hello 1.0-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ hello ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 0 resource
[INFO] Copying 0 resource
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ hello ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 2 source files to C:\Users\18236\Desktop\Recent\hello\target\classes
[INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ hello ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory C:\Users\18236\Desktop\Recent\hello\src\test\resources
[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ hello ---
[INFO] No sources to compile
[INFO] --- maven-surefire-plugin:2.22.2:test (default-test) @ hello ---
[INFO] No tests to run.
[INFO] --- maven-jar-plugin:3.1.2:jar (default-jar) @ hello ---
[INFO] Building jar: C:\Users\18236\Desktop\Recent\hello\target\hello-1.0-SNAPSHOT.jar
[INFO] --- spring-boot-maven-plugin:2.2.5.RELEASE:repackage (repackage) @ hello ---
[INFO] Replacing main artifact with repackaged archive
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  5.534 s
[INFO] Finished at: 2020-12-10T17:54:11+08:00
[INFO] ------------------------------------------------------------------------<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>ç¼–å†™Dockerfile</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">FROM java:8

COPY *.jar /app.jar

CMD ["--server.port=8080"]

EXPOSE 8080

ENTRYPOINT ["java", "-jar", "/app.jar"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>é€šè¿‡Xftpå°†æ„å»ºå¥½çš„jaråŒ…å’ŒDockerFileå‘é€åˆ°è™šæ‹Ÿæœº</p>
<blockquote>
<p>æ„å»ºé•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@parak hello]# docker build -t hello .
Sending build context to Docker daemon   17.6MB
Step 1/5 : FROM java:8
 ---> d23bdf5b1b1b
Step 2/5 : COPY *.jar /app.jar
 ---> 34774df7a107
Step 3/5 : CMD ["--server.port=8080"]
 ---> [Warning] IPv4 forwarding is disabled. Networking will not work.
 ---> Running in 11d95474e047
Removing intermediate container 11d95474e047
 ---> e8b6fa21a3a0
Step 4/5 : EXPOSE 8080
 ---> [Warning] IPv4 forwarding is disabled. Networking will not work.
 ---> Running in 896cc7d50875
Removing intermediate container 896cc7d50875
 ---> b139242b232d
Step 5/5 : ENTRYPOINT ["java", "-jar", "/app.jar"]
 ---> [Warning] IPv4 forwarding is disabled. Networking will not work.
 ---> Running in 562f3bb605a0
Removing intermediate container 562f3bb605a0
 ---> 1d28463205d5
Successfully built 1d28463205d5
Successfully tagged hello:latest<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>è¿è¡Œé•œåƒ</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">[root@parak hello]# docker run -d -it -p 8001:8080 hello
7e19b364789de18c736c51e5c84d611e7474d3a733f188220dfd7cc011e55729
[root@parak hello]# curl http://192.168.117.155:8001/hello/KKK
Hello, KKK

 -from KHighness<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="â­•ç›¸å…³é—®é¢˜"><a href="#â­•ç›¸å…³é—®é¢˜" class="headerlink" title="â­•ç›¸å…³é—®é¢˜"></a>â­•ç›¸å…³é—®é¢˜</h2><blockquote>
<p>è§£å†³é—®é¢˜1: WARNING: IPv4 forwarding is disabled. Networking will not work.</p>
</blockquote>
<pre class="line-numbers language-shell"><code class="language-shell">$ echo "net.ipv4.ip_forward=1" >>/usr/lib/sysctl.d/00-system.conf
$ systemctl restart network && systemctl restart docker<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<blockquote>
<p>è§£å†³é—®é¢˜2: ä½¿ç”¨é˜¿é‡Œäº‘æœåŠ¡å™¨è¿è¡Œä¸€ä¸ªå®¹å™¨ï¼Œå¤–éƒ¨IPä¸èƒ½è®¿é—®</p>
</blockquote>
<p>éœ€è¦åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨é…ç½®é˜²ç«å¢™ç›¸å…³ç«¯å£å¯¹å¤–å¼€æ”¾ã€‚</p>
<p>æ¯”å¦‚è·‘ä¸€ä¸ªå¼€æ”¾ç«¯å£ä¸º3333çš„springbootåº”ç”¨éœ€è¦åœ¨é˜¿é‡Œäº‘æœåŠ¡å™¨æ§åˆ¶å°çš„é˜²ç«å¢™æ·»åŠ è§„åˆ™:</p>
<img src="/posts/f5f9fa9b/image-20201211233834182.png" class="" title="image-20201211233834182">



 
      <!-- reward -->
      
      <div id="reword-out">
        <div id="reward-btn">
          æ‰“èµ
        </div>
      </div>
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>
          
          æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œè‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=http://example.com/posts/f5f9fa9b/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/posts/c24675b4/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            MySQL
          
        </div>
      </a>
    
    
      <a href="/posts/33422a09/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">è´Ÿè·ç¦»</div>
      </a>
    
  </nav>

   
<!-- valineè¯„è®º -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<!-- <script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script> -->
<!-- <script src="//unpkg.com/valine/dist/Valine.min.js"></script> -->
<script src="/js/Valine.min.js"></script>

<style>
    /* è®¾ç½®è¯„è®ºèƒŒæ™¯ */
    #veditor{min-height: 10rem;
        background-image: url('/images/comment-bg.jpg');
        background-size: contain;
        background-repeat: no-repeat;
        background-position: right;
        background-color: rgba(255,255,255,0);
        resize: none;
    }

    /* è®¾ç½®å¤´åƒæ—‹è½¬ */
    .v .vcards .vcard .vimg {
        width: 3.125em;
        height: 3.125em;
        float: left;
        border-radius: 50%;
        margin-right: .7525em;
        padding: 0.125em;
        border: 1px solid #FFA500;
        opacity: 1;
        transition: all 1.0s;
    }

    .v .vcards .vcard .vimg:hover {
        box-shadow: 0 0 10px #fff;
        -webkit-box-shadow: 0 0 19px #fff;
        transform:rotate(360deg);
        -ms-transform:rotate(360deg); 	  /* IE 9 */
        -moz-transform:rotate(360deg); 	  /* Firefox */
        -webkit-transform:rotate(360deg); /* Safari å’Œ Chrome */
        -o-transform:rotate(360deg); 	  /* Opera */
        filter:progid:DXImageTransform.Microsoft.BasicImage(rotation=3);
    }
</style>
<!-- Valineé…ç½® -->
<script>
    new Valine({
        el: '#vcomments',
        enableQQ: true,
        app_id: 'Py2eOHzSdrnxKPzKrOJaHJOq-9Nh9j0Va',
        app_key: '9eQhwuCgyshpYKn4rtEhqt4R',
        path: window.location.pathname,
        //notify: 'false',
        //verify: 'false',
        avatar: 'wavatar',
        placeholder: 'å»ºè®®ä½¿ç”¨QQé‚®ç®±ï¼Œä¼šè‡ªåŠ¨è·å–QQå¤´åƒ~',
        recordIP: true,

        // è®¾ç½®Bilibiliè¡¨æƒ…åŒ…åœ°å€
        emojiCDN: '//i0.hdslb.com/bfs/emote/',
        // è¡¨æƒ…titleå’Œå›¾ç‰‡æ˜ å°„
        emojiMaps: {
           "tv_doge": "6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png",
            "tv_äº²äº²": "a8111ad55953ef5e3be3327ef94eb4a39d535d06.png",
            "tv_å·ç¬‘": "bb690d4107620f1c15cff29509db529a73aee261.png",
            "tv_å†è§": "180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png",
            "tv_å†·æ¼ ": "b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png",
            "tv_å‘æ€’": "34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png",
            "tv_å‘è´¢": "34db290afd2963723c6eb3c4560667db7253a21a.png",
            "tv_å¯çˆ±": "9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png",
            "tv_åè¡€": "09dd16a7aa59b77baa1155d47484409624470c77.png",
            "tv_å‘†": "fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png",
            "tv_å‘•å": "9f996894a39e282ccf5e66856af49483f81870f3.png",
            "tv_å›°": "241ee304e44c0af029adceb294399391e4737ef2.png",
            "tv_åç¬‘": "1f0b87f731a671079842116e0991c91c2c88645a.png",
            "tv_å¤§ä½¬": "093c1e2c490161aca397afc45573c877cdead616.png",
            "tv_å¤§å“­": "23269aeb35f99daee28dda129676f6e9ea87934f.png",
            "tv_å§”å±ˆ": "d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png",
            "tv_å®³ç¾": "a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png",
            "tv_å°´å°¬": "7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png",
            "tv_å¾®ç¬‘": "70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png",
            "tv_æ€è€ƒ": "90cf159733e558137ed20aa04d09964436f618a1.png",
            "tv_æƒŠå“": "0d15c7e2ee58e935adc6a7193ee042388adc22af.png",
            // ... æ›´å¤šè¡¨æƒ…
        }
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>

<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

 
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2021
        <i class="ri-heart-fill heart_icon"></i> Khighness
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>è®¿é—®äººæ•°:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>æµè§ˆæ¬¡æ•°:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
        <script type="text/javascript" src='https://s4.cnzz.com/z_stat.php?id=1279324689&amp;web_id=1279324689'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="https://cdn.jsdelivr.net/gh/Khighness/Khighness.github.io/images/Khighness.jpg" alt="Khighness"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äº</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.tidio.com/talk/Khighness">è”ç³»</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="æœç´¢">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>æ¥æ¯æŠ¹èŒ¶ï¼Ÿ</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Khighness/Khighness.github.io/images/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Khighness/Khighness.github.io/images/wepay.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>

<!-- Katex -->


    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
        
    


<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


    
  </div>
  <!-- ç™¾åº¦ç»Ÿè®¡ -->
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?97974cf7c750ac7da47173f2992d6970";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
  <!-- ä¸‰è§’å½©å¸¦èƒŒæ™¯ -->
  <canvas id="evanyou-canvas" style="opacity: 0.3; position: fixed; top: 0px; left: 0px; z-index: -1; width: 100%; height: 100%; pointer-events: none;"></canvas>
  <script src="/js/evanyou-canvas.js"></script>
  <!-- Tidioå³æ—¶èŠå¤©-->
  <script src="//code.tidio.co/ao1f4qdjllf8yowzz7v5brdaejt42uoi.js" async></script>
</body>

</html>
